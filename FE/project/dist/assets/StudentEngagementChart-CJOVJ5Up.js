import{r as i,e as ve,R as xe,j as o,C as G,a as V,b as M,c as $}from"./index-Ncio_aso.js";import{c as R,s as U,a as Q,b as ee,d as ye,j as ge,i as Ie,h as H,p as Pe,r as te,D as Ae,u as ae,k as be,S as Ee,l as je,n as re,o as Ce,w as Le,q as ke,v as Se,x as we,Z as De,L as Oe,y as ne,z as X,F as Y,B as Be,J as Ne,E as S,H as Te,I as Re,M as _e,K as We,Q as Ke,R as Fe,T as ze}from"./CategoricalChart-D66cckQl.js";import{u as Ge,G as Ve,a as Me,C as $e,X as He,Y as Z}from"./CartesianChart-C3n-Q8Q0.js";import{L as Xe}from"./Legend-C5xP9T8b.js";import{S as Ye,B as Ze}from"./barSelectors-Cz9a59dm.js";import{g as qe,A as Je,D as Ue}from"./getRadiusAndStrokeWidthFromDot-CddYn3aj.js";import{S as Qe}from"./tooltipContext-jPMpA2RG.js";var ie=(e,a,r,t)=>Q(e,"xAxis",a,t),se=(e,a,r,t)=>ee(e,"xAxis",a,t),oe=(e,a,r,t)=>Q(e,"yAxis",r,t),le=(e,a,r,t)=>ee(e,"yAxis",r,t),et=R([U,ie,oe,se,le],(e,a,r,t,n)=>Ie(e,"xAxis")?H(a,t,!1):H(r,n,!1)),tt=(e,a,r,t,n)=>n;function at(e){return e.type==="line"}var rt=R([ge,tt],(e,a)=>e.filter(at).find(r=>r.id===a)),nt=R([U,ie,oe,se,le,rt,et,ye],(e,a,r,t,n,s,l,c)=>{var{chartData:d,dataStartIndex:u,dataEndIndex:h}=c;if(!(s==null||a==null||r==null||t==null||n==null||t.length===0||n.length===0||l==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:p,data:m}=s,f;if(m!=null&&m.length>0?f=m:f=d==null?void 0:d.slice(u,h+1),f!=null)return Et({layout:e,xAxis:a,yAxis:r,xAxisTicks:t,yAxisTicks:n,dataKey:p,bandSize:l,displayedData:f})}}),it=["id"],st=["type","layout","connectNulls","needClip","shape"],ot=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function w(){return w=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var t in r)({}).hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},w.apply(null,arguments)}function q(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function P(e){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?q(Object(r),!0).forEach(function(t){lt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function lt(e,a,r){return(a=dt(a))in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function dt(e){var a=ct(e,"string");return typeof a=="symbol"?a:a+""}function ct(e,a){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var t=r.call(e,a);if(typeof t!="object")return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function _(e,a){if(e==null)return{};var r,t,n=ut(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)r=s[t],a.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ut(e,a){if(e==null)return{};var r={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(a.indexOf(t)!==-1)continue;r[t]=e[t]}return r}var pt=e=>{var{dataKey:a,name:r,stroke:t,legendType:n,hide:s}=e;return[{inactive:s,dataKey:a,type:n,color:t,value:re(r,a),payload:e}]},ht=i.memo(e=>{var{dataKey:a,data:r,stroke:t,strokeWidth:n,fill:s,name:l,hide:c,unit:d,tooltipType:u}=e,h={dataDefinedOnItem:r,positions:void 0,settings:{stroke:t,strokeWidth:n,fill:s,dataKey:a,nameKey:void 0,name:re(l,a),hide:c,type:u,color:t,unit:d}};return i.createElement(Ce,{tooltipEntrySettings:h})}),de=(e,a)=>"".concat(a,"px ").concat(e-a,"px");function mt(e,a){for(var r=e.length%2!==0?[...e,0]:e,t=[],n=0;n<a;++n)t=[...t,...r];return t}var ft=(e,a,r)=>{var t=r.reduce((p,m)=>p+m);if(!t)return de(a,e);for(var n=Math.floor(e/t),s=e%t,l=a-e,c=[],d=0,u=0;d<r.length;u+=r[d],++d)if(u+r[d]>s){c=[...r.slice(0,d),s-u];break}var h=c.length%2===0?[0,l]:[l];return[...mt(r,n),...c,...h].map(p=>"".concat(p,"px")).join(", ")};function vt(e){var{clipPathId:a,points:r,props:t}=e,{dot:n,dataKey:s,needClip:l}=t,{id:c}=t,d=_(t,it),u=We(d);return i.createElement(Ue,{points:r,dot:n,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:u,needClip:l,clipPathId:a})}function xt(e){var{showLabels:a,children:r,points:t}=e,n=i.useMemo(()=>t==null?void 0:t.map(s=>{var l,c,d={x:(l=s.x)!==null&&l!==void 0?l:0,y:(c=s.y)!==null&&c!==void 0?c:0,width:0,lowerWidth:0,upperWidth:0,height:0};return P(P({},d),{},{value:s.value,payload:s.payload,viewBox:d,parentViewBox:void 0,fill:void 0})}),[t]);return i.createElement(Re,{value:a?n:void 0},r)}function J(e){var{clipPathId:a,pathRef:r,points:t,strokeDasharray:n,props:s}=e,{type:l,layout:c,connectNulls:d,needClip:u,shape:h}=s,p=_(s,st),m=P(P({},_e(p)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(a,")"):void 0,points:t,type:l,layout:c,connectNulls:d,strokeDasharray:n??s.strokeDasharray});return i.createElement(i.Fragment,null,(t==null?void 0:t.length)>1&&i.createElement(Qe,w({shapeType:"curve",option:h},m,{pathRef:r})),i.createElement(vt,{points:t,clipPathId:a,props:s}))}function yt(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function gt(e){var{clipPathId:a,props:r,pathRef:t,previousPointsRef:n,longestAnimatedLengthRef:s}=e,{points:l,strokeDasharray:c,isAnimationActive:d,animationBegin:u,animationDuration:h,animationEasing:p,animateNewValues:m,width:f,height:I,onAnimationEnd:v,onAnimationStart:b}=r,A=n.current,x=Be(l,"recharts-line-"),y=i.useRef(x),[C,L]=i.useState(!1),O=!C,B=i.useCallback(()=>{typeof v=="function"&&v(),L(!1)},[v]),N=i.useCallback(()=>{typeof b=="function"&&b(),L(!0)},[b]),E=yt(t.current),D=i.useRef(0);y.current!==x&&(D.current=s.current,y.current=x);var W=D.current;return i.createElement(xt,{points:l,showLabels:O},r.children,i.createElement(Ne,{animationId:x,begin:u,duration:h,isActive:d,easing:p,onAnimationEnd:B,onAnimationStart:N,key:x},j=>{var pe=S(W,E+W,j),T=Math.min(pe,E),k;if(d)if(c){var he="".concat(c).split(/[,\s]+/gim).map(g=>parseFloat(g));k=ft(T,E,he)}else k=de(E,T);else k=c==null?void 0:String(c);if(j>0&&E>0&&(n.current=l,s.current=Math.max(s.current,T)),A){var me=A.length/l.length,K=j===1?l:l.map((g,fe)=>{var F=Math.floor(fe*me);if(A[F]){var z=A[F];return P(P({},g),{},{x:S(z.x,g.x,j),y:S(z.y,g.y,j)})}return m?P(P({},g),{},{x:S(f*2,g.x,j),y:S(I/2,g.y,j)}):P(P({},g),{},{x:g.x,y:g.y})});return n.current=K,i.createElement(J,{props:r,points:K,clipPathId:a,pathRef:t,strokeDasharray:k})}return i.createElement(J,{props:r,points:l,clipPathId:a,pathRef:t,strokeDasharray:k})}),i.createElement(Te,{label:r.label}))}function It(e){var{clipPathId:a,props:r}=e,t=i.useRef(null),n=i.useRef(0),s=i.useRef(null);return i.createElement(gt,{props:r,clipPathId:a,previousPointsRef:t,longestAnimatedLengthRef:n,pathRef:s})}var Pt=(e,a)=>{var r,t;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(t=e.y)!==null&&t!==void 0?t:void 0,value:e.value,errorVal:ne(e.payload,a)}};class At extends i.Component{render(){var{hide:a,dot:r,points:t,className:n,xAxisId:s,yAxisId:l,top:c,left:d,width:u,height:h,id:p,needClip:m,zIndex:f}=this.props;if(a)return null;var I=ve("recharts-line",n),v=p,{r:b,strokeWidth:A}=qe(r),x=we(r),y=b*2+A,C=m?"url(#clipPath-".concat(x?"":"dots-").concat(v,")"):void 0;return i.createElement(De,{zIndex:f},i.createElement(Oe,{className:I},m&&i.createElement("defs",null,i.createElement(Ve,{clipPathId:v,xAxisId:s,yAxisId:l}),!x&&i.createElement("clipPath",{id:"clipPath-dots-".concat(v)},i.createElement("rect",{x:d-y/2,y:c-y/2,width:u+y,height:h+y}))),i.createElement(Ye,{xAxisId:s,yAxisId:l,data:t,dataPointFormatter:Pt,errorBarOffset:0},i.createElement(It,{props:this.props,clipPathId:v}))),i.createElement(Je,{activeDot:this.props.activeDot,points:t,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:C}))}}var ce={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Ae.line,type:"linear"};function bt(e){var a=te(e,ce),{activeDot:r,animateNewValues:t,animationBegin:n,animationDuration:s,animationEasing:l,connectNulls:c,dot:d,hide:u,isAnimationActive:h,label:p,legendType:m,xAxisId:f,yAxisId:I,id:v}=a,b=_(a,ot),{needClip:A}=Ge(f,I),x=Le(),y=ke(),C=ae(),L=Se(D=>nt(D,f,I,C,v));if(y!=="horizontal"&&y!=="vertical"||L==null||x==null)return null;var{height:O,width:B,x:N,y:E}=x;return i.createElement(At,w({},b,{id:v,connectNulls:c,dot:d,activeDot:r,animateNewValues:t,animationBegin:n,animationDuration:s,animationEasing:l,isAnimationActive:h,hide:u,label:p,legendType:m,xAxisId:f,yAxisId:I,points:L,layout:y,height:O,width:B,left:N,top:E,needClip:A}))}function Et(e){var{layout:a,xAxis:r,yAxis:t,xAxisTicks:n,yAxisTicks:s,dataKey:l,bandSize:c,displayedData:d}=e;return d.map((u,h)=>{var p=ne(u,l);if(a==="horizontal"){var m=X({axis:r,ticks:n,bandSize:c,entry:u,index:h}),f=Y(p)?null:t.scale(p);return{x:m,y:f,value:p,payload:u}}var I=Y(p)?null:r.scale(p),v=X({axis:t,ticks:s,bandSize:c,entry:u,index:h});return I==null||v==null?null:{x:I,y:v,value:p,payload:u}}).filter(Boolean)}function jt(e){var a=te(e,ce),r=ae();return i.createElement(be,{id:a.id,type:"line"},t=>i.createElement(i.Fragment,null,i.createElement(Ee,{legendPayload:pt(a)}),i.createElement(ht,{dataKey:a.dataKey,data:a.data,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.fill,name:a.name,hide:a.hide,unit:a.unit,tooltipType:a.tooltipType}),i.createElement(je,{type:"line",id:t,data:a.data,xAxisId:a.xAxisId,yAxisId:a.yAxisId,zAxisId:0,dataKey:a.dataKey,hide:a.hide,isPanorama:r}),i.createElement(bt,w({},a,{id:t}))))}var ue=i.memo(jt,Pe);ue.displayName="Line";var Ct=["axis"],Lt=i.forwardRef((e,a)=>i.createElement(Me,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ct,tooltipPayloadSearcher:Ke,categoricalChartProps:e,ref:a}));const kt=({data:e})=>{if(!e||e.length===0)return o.jsxs(G,{children:[o.jsx(V,{children:o.jsx(M,{children:"Hoạt động học viên"})}),o.jsx($,{children:o.jsx("div",{className:"flex items-center justify-center h-[300px] text-gray-500",role:"status","aria-label":"Không có dữ liệu hoạt động",children:"Không có dữ liệu hoạt động học viên"})})]});const a=i.useMemo(()=>[...e].sort((t,n)=>t.weekIndex-n.weekIndex).map(t=>({weekIndex:t.weekIndex,displayWeek:`Tuần ${t.weekIndex}`,hours:t.hours,lessonCount:t.lessonCount})),[e]),r=i.useCallback(({active:t,payload:n})=>{if(t&&n&&n.length){const s=n[0].payload;return o.jsxs("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[o.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.displayWeek}),o.jsxs("p",{className:"text-sm text-blue-600 mt-1",children:["Giờ học: ",s.hours.toFixed(2)]}),o.jsxs("p",{className:"text-sm text-green-600",children:["Bài học: ",s.lessonCount]})]})}return null},[]);return o.jsxs(G,{children:[o.jsx(V,{children:o.jsx(M,{children:"Hoạt động học viên"})}),o.jsx($,{className:"pt-4",children:o.jsx("div",{className:"w-full overflow-x-auto",role:"img","aria-label":"Combined chart showing student engagement with hours watched and lessons completed per week",children:o.jsx(Fe,{width:"100%",height:300,minWidth:400,children:o.jsxs(Lt,{data:a,margin:{top:5,right:30,left:20,bottom:5},accessibilityLayer:!0,children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"hoursGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"#3B82F6",stopOpacity:.8}),o.jsx("stop",{offset:"100%",stopColor:"#3B82F6",stopOpacity:.4})]}),o.jsxs("linearGradient",{id:"lessonsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"#10B981",stopOpacity:.8}),o.jsx("stop",{offset:"100%",stopColor:"#10B981",stopOpacity:.4})]})]}),o.jsx($e,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),o.jsx(He,{dataKey:"displayWeek",stroke:"#6B7280",fontSize:12,tickLine:!1}),o.jsx(Z,{yAxisId:"left",stroke:"#3B82F6",fontSize:12,tickLine:!1,label:{value:"Giờ",angle:-90,position:"insideLeft",style:{fill:"#3B82F6"}},tickFormatter:t=>t.toFixed(1)}),o.jsx(Z,{yAxisId:"right",orientation:"right",stroke:"#10B981",fontSize:12,tickLine:!1,label:{value:"Bài học",angle:90,position:"insideRight",style:{fill:"#10B981"}}}),o.jsx(ze,{content:o.jsx(r,{})}),o.jsx(Xe,{wrapperStyle:{paddingTop:"20px"},iconType:"line"}),o.jsx(Ze,{yAxisId:"right",dataKey:"lessonCount",fill:"url(#lessonsGradient)",name:"Bài học hoàn thành",radius:[8,8,0,0]}),o.jsx(ue,{yAxisId:"left",type:"monotone",dataKey:"hours",stroke:"#3B82F6",strokeWidth:3,name:"Giờ học đã xem",dot:{fill:"#3B82F6",r:4},activeDot:{r:6}})]})})})})]})},Rt=xe.memo(kt);export{Rt as default};
